<script type="text/javascript">
    RED.nodes.registerType('couchdb-list-dbs', {
        category: 'couchdb',
        color: '#ff6b00',
        defaults: {
            name: {value: ""},
            server: {type: "couchdb-server", required: true}
        },
        inputs: 1,
        outputs: 2,
        outputLabels: ["success", "error"],
        icon: "database.png",
        label: function() {
            return this.name || "list databases";
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        }
    });
</script>

<script type="text/html" data-template-name="couchdb-list-dbs">
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="List Databases">
    </div>
</script>

<script type="text/html" data-help-name="couchdb-list-dbs">
    <p>Lists all databases on a CouchDB server.</p>

    <h3>Outputs</h3>
    <ol class="node-ports">
        <li>Success
            <dl class="message-properties">
                <dt>payload <span class="property-type">array</span></dt>
                <dd>Array of database names</dd>
                <dt>databases <span class="property-type">array</span></dt>
                <dd>Same as payload - array of database names</dd>
                <dt>count <span class="property-type">number</span></dt>
                <dd>Number of databases found</dd>
            </dl>
        </li>
        <li>Error
            <dl class="message-properties">
                <dt>error <span class="property-type">object</span></dt>
                <dd>Error details if the operation fails</dd>
            </dl>
        </li>
    </ol>

    <h3>Details</h3>
    <p>This node retrieves a list of all databases on the configured CouchDB server.</p>
    <p>No input is required - the node will list all databases when triggered.</p>

    <h3>Example Output</h3>
    <pre>{
  "payload": ["_replicator", "_users", "node-red-flows", "metrics"],
  "databases": ["_replicator", "_users", "node-red-flows", "metrics"],
  "count": 4
}</pre>

    <h3>Use Cases</h3>
    <ul>
        <li>Admin dashboards showing all databases</li>
        <li>Database discovery and selection UI</li>
        <li>Health checks and monitoring</li>
        <li>Backup and migration tools</li>
    </ul>

    <h3>Required Permissions</h3>
    <p>The configured user must have server admin rights to list all databases.</p>
</script>
